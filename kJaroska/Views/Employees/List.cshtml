@using System.Web.Mvc.Html
@model IEnumerable<kJaroska.Models.Employee>

@{
    ViewBag.Title = "Employees";
}


<h2>List of your employees</h2>

<div id="tab">
    <table id="employeeList" class="table">
        <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.FirstName)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.HireDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Department)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Grade)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ManagerId)
            </th>
        </tr>
        <tr>
            <th>
                <label for="names">Sort by Surname</label><br/>
                <input id="names" placeholder="Name.." runat="server"/>
                <script>
                    $("#names").autocomplete({
                        source: 'Controllers/Handlers/NameSortHandler.ashx',
                        select: function (event, ui) {
                            var searchQuery = ui.item.value;

                            $("#tabBody").load('/Employees/SortByNames?query=' + searchQuery);               
                        }
                    });
                </script>
            </th>
            <th>
                <label for="datarange">Sort by Date Range</label><br/>
                <input type="text" id="datarange" name="daterange" value="01/01/2017 - 01/01/2017"/>

                <script type="text/javascript">
                    $(function() {
                        $('input[name="daterange"]').daterangepicker();
                        $("#datarange").on("apply.daterangepicker",
                            function(event, picker) {
                                var start = picker.startDate.format("DD-MM-YYYY");
                                var end = picker.endDate.format("DD-MM-YYYY");

                                $("#tabBody").load("/Employees/SortByDates?from=" + start + "&to=" + end);
                            });
                    });
                </script>
            </th>
            <th>
                <select id="department">
                    <option>Executive</option>
                    <option>Finance</option>
                    <option>HR</option>
                    <option>Marketing</option>
                    <option selected="selected">Production</option>
                    <option>Logistics</option>
                </select>

                <script>
                    $("#department").selectmenu({ width: 'auto' });

                    $("#department").on("selectmenuchange", function () {
                        var department = $(this).val();

                        $("#tabBody").load("/Employees/SortByDepartments?department=" + department);
                    });
                </script>
            </th>
            <th>
                <select id="grade">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                    <option>6</option>
                    <option>7</option>
                    <option>8</option>
                    <option>9</option>
                    <option>10</option>
                </select>

                <script>
                    $("#grade").selectmenu({ width: 'auto' });

                    $("#grade").on("selectmenuchange",function() {
                        var grade = $(this).val();

                        $("#tabBody").load("/Employees/SortByGrades?grade=" + grade);
                    });
                </script>
            </th>
            <th>
                <select id="manager">
                    <option>John Doe</option>
                    <option>Jackie Mazzoni</option>
                    <option>Shonna Gugino</option>
                    <option>Bryon Fairley</option>
                    <option>Ronald McMullen</option>
                    <option>Audrey Vencil</option>
                </select>
                <script>
                    $("#manager").selectmenu({ width: 'auto' });

                    $("#manager").on("selectmenuchange",
                        function() {
                            var manager = $(this).val();
                            manager = manager.split(" ");

                            $("#tabBody").load('/Employees/SortByManager?firstName=' + manager[0] + "&lastname=" + manager[1]);
                        });
                </script>
            </th>
        </tr>

        </thead>

        <tbody id="tabBody">
        @foreach (var employee in Model)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => employee.FirstName)
                    @Html.DisplayFor(modelItem => employee.LastName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => employee.HireDate)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => employee.Department)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => employee.Grade)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => employee.Manager.FirstName) @Html.DisplayFor(modelItem => employee.Manager.LastName)
                </td>
            </tr>
        }
        </tbody>

    </table>
</div>


